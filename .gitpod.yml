# TODO: Replace gitpod with master
image: ghcr.io/conda/conda-ci:gitpod-linux-python3.9
tasks:
  - name: initialize
    init: |
      mkdir -p .vscode
      echo '{"python.pythonPath": "/opt/conda/bin/python"}' > .vscode/settings.json
      git tag "$(git tag --sort=committerdate | tail -1).dev"
      eval "$(sudo /opt/conda/bin/python -m conda init --dev bash)"
      sudo su root -c "/opt/conda/bin/conda install -yq conda-build"
      conda install --file requirements.txt
      cd notebooks
    command: for f in *.ipynb; do jupyter nbconvert --execute --to notebook --inplace "$f"; done

vscode:
  extensions:
    - eamodio.gitlens
    - ms-python.python
    - ms-python.vscode-pylance
